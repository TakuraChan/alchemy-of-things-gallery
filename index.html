<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="Works by Takura, between observation, emotion, and form.">
    <title>Alchemy of Things</title>
    <link rel="icon" type="image/svg+xml" href="/images/symbol.svg">
    <meta property="og:title" content="Alchemy of Things">
    <meta property="og:description" content="Works by Takura, between observation, emotion, and form.">
    <meta property="og:image" content="/images/symbol.svg">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,400&family=Jost:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="nav">
        <div class="nav-links"></div>
    </nav>
    <main class="main">
        <div class="landing-page" id="landing">
            <img src="/images/symbol.svg" alt="" class="landing-symbol">
            <img id="landing-img" src="" alt="" class="landing-image">
            <button class="landing-enter" id="enter-btn">Enter</button>
        </div>
        <div class="hub-page" id="hub" style="display:none;">
            <img src="/images/symbol.svg" alt="" class="hub-symbol">
            <nav class="hub-nav" id="hub-nav"></nav>
        </div>
    </main>
    <footer class="footer">
        <div class="footer-content">
            <img src="/images/symbol.svg" alt="" class="symbol-footer">
            <p class="footer-text">alchemy of things</p>
        </div>
    </footer>
    <script src="/js/nav.js"></script>
    <script src="/js/main.js"></script>
    <script>
        const landing=document.getElementById('landing');
        const hub=document.getElementById('hub');
        const nav=document.querySelector('.nav');
        const footer=document.querySelector('.footer');
        const landingImg=document.getElementById('landing-img');
        const hasVisited=sessionStorage.getItem('hasVisited');

        // Build hub navigation from categories
        async function buildHubNav(){
            const hubNav=document.getElementById('hub-nav');
            try{
                const r=await fetch('/data/categories.json?_='+Date.now());
                const categories=await r.json();
                let links='';
                categories.filter(c=>c.visible!==false).sort((a,b)=>a.order-b.order).forEach(c=>{
                    const href=c.id==='paintings'?'/paintings.html':c.id==='photography'?'/photography.html':'/'+c.id+'.html';
                    links+=`<a href="${href}">${c.name}</a>`;
                });
                links+='<a href="/about.html">About</a>';
                hubNav.innerHTML=links;
            }catch{
                hubNav.innerHTML='<a href="/paintings.html">Paintings</a><a href="/photography.html">Photography</a><a href="/about.html">About</a>';
            }
        }

        // Check if user has visited before
        if(hasVisited){
            // Skip landing page - go straight to hub
            landing.style.display='none';
            hub.style.display='flex';
            nav.style.display='none';
            buildHubNav();
        }else{
            // First visit - show landing page
            nav.style.display='none';
            footer.style.display='none';
        }

        // Load landing image
        getContent().then(c=>{
            if(c.paintings?.landingImage && c.paintings.landingImage.trim()){
                landingImg.src=c.paintings.landingImage + '?_=' + Date.now();
                landingImg.style.display='block';
            }else{
                landingImg.style.display='none';
            }
        }).catch(()=>{
            landingImg.style.display='none';
        });

        // Enter button click
        document.getElementById('enter-btn').addEventListener('click',()=>{
            sessionStorage.setItem('hasVisited','true');
            landing.style.opacity='0';
            setTimeout(()=>{
                landing.style.display='none';
                hub.style.display='flex';
                footer.style.display='flex';
                buildHubNav();
            },600);
        });
    </script>
</body>
</html>
