<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="Works by Takura, between observation, emotion, and form.">
    <title>Alchemy of Things</title>
    <link rel="icon" type="image/svg+xml" href="/images/symbol.svg">
    <meta property="og:title" content="Alchemy of Things">
    <meta property="og:description" content="Works by Takura, between observation, emotion, and form.">
    <meta property="og:image" content="/images/symbol.svg">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,400&family=Jost:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="nav">
        <div class="nav-links"></div>
    </nav>
    <main class="main">
        <div class="landing-page" id="landing" style="display:none;">
            <img src="/images/symbol.svg" alt="" class="landing-symbol">
            <img id="landing-img" src="" alt="" class="landing-image">
            <button class="landing-enter" id="enter-btn">Enter</button>
        </div>
        <p class="section-note" id="paintings-desc"></p>
        <section class="works" id="works"></section>
    </main>
    <footer class="footer">
        <div class="footer-content">
            <img src="/images/symbol.svg" alt="" class="symbol-footer">
            <p class="footer-text">alchemy of things</p>
        </div>
    </footer>
    <script src="/js/nav.js"></script>
    <script src="/js/main.js"></script>
    <script>
        const landing=document.getElementById('landing');
        const works=document.getElementById('works');
        const nav=document.querySelector('.nav');
        const footer=document.querySelector('.footer');
        const landingImg=document.getElementById('landing-img');
        const hasVisited=sessionStorage.getItem('hasVisited');

        // Load content and setup page
        fetch('/data/content.json')
            .then(r=>r.json())
            .then(c=>{
                // Set paintings description
                if(c.paintings?.description){
                    document.getElementById('paintings-desc').textContent=c.paintings.description;
                }

                // Load landing image if exists
                if(c.paintings?.landingImage && c.paintings.landingImage.trim()){
                    landingImg.src=c.paintings.landingImage;
                    landingImg.style.display='block';
                }else{
                    landingImg.style.display='none';
                }

                // Show landing page only on first visit
                if(!hasVisited){
                    landing.style.display='flex';
                    nav.style.display='none';
                    footer.style.display='none';
                    works.style.opacity='0';
                }else{
                    // Regular visit - go straight to paintings
                    landing.style.display='none';
                    loadCollections('paintings');
                    setTimeout(()=>{works.style.opacity='1'},50);
                }
            })
            .catch(()=>{
                // On error, go straight to paintings
                if(!hasVisited){
                    landing.style.display='flex';
                    nav.style.display='none';
                    footer.style.display='none';
                }else{
                    loadCollections('paintings');
                    setTimeout(()=>{works.style.opacity='1'},50);
                }
            });

        // Enter button click
        document.getElementById('enter-btn').addEventListener('click',()=>{
            sessionStorage.setItem('hasVisited','true');
            landing.style.opacity='0';
            setTimeout(()=>{
                landing.style.display='none';
                works.style.display='flex';
                nav.style.display='flex';
                footer.style.display='flex';
                loadCollections('paintings');
                setTimeout(()=>{works.style.opacity='1'},50);
            },600);
        });

        // Symbol click returns to landing page
        setTimeout(()=>{
            const symbolLink=document.querySelector('.nav-links a[href="/"]');
            if(symbolLink){
                symbolLink.addEventListener('click',(e)=>{
                    if(window.location.pathname==='/'||window.location.pathname==='/index.html'){
                        e.preventDefault();
                        sessionStorage.removeItem('hasVisited');
                        location.reload();
                    }
                });
            }
        },100);
    </script>
</body>
</html>
